import{a9 as u,r,a3 as p}from"./index-BwdTnk9D.js";const a=()=>{const e=localStorage.getItem("weekly-reports");if(!e)return[];try{return JSON.parse(e).map(l=>{if(typeof l.content=="string")try{l.content=JSON.parse(l.content)}catch{l.content={accomplishments:l.content||"",challenges:"",nextWeekPlan:""}}return l.content||(l.content={accomplishments:"",challenges:"",nextWeekPlan:""}),l})}catch(s){return console.error("Failed to parse reports from localStorage",s),[]}},S=u("report",()=>{const e=r(a()),s=r(null),l=()=>{e.value=a()};return p(e,t=>{localStorage.setItem("weekly-reports",JSON.stringify(t))},{deep:!0}),{reports:e,currentReport:s,addReport:t=>{const n=typeof t.content=="string"?{accomplishments:t.content,challenges:"",nextWeekPlan:""}:t.content,o={...t,content:n,id:Date.now().toString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return e.value.push(o),o},updateReport:(t,n)=>{const o=e.value.findIndex(c=>c.id===t);if(o!==-1){let c=e.value[o].content;n.content&&(typeof n.content=="string"?c={accomplishments:n.content,challenges:"",nextWeekPlan:""}:c={...c,...n.content}),e.value[o]={...e.value[o],...n,content:c,updatedAt:new Date().toISOString()}}},deleteReport:t=>{const n=e.value.findIndex(o=>o.id===t);n!==-1&&e.value.splice(n,1)},getReport:t=>{if(!t)return null;console.log("查找报告:",t),console.log("当前报告数量:",e.value.length);const n=e.value.find(o=>o.id===t);return n?console.log("找到报告:",n.title):console.log("未找到报告ID:",t),n||null},clearAllReports:()=>{e.value=[],localStorage.removeItem("weekly-reports")},initializeReports:l}});export{S as u};
